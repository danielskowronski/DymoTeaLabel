<div id="xml" style="display: none">
PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPENvbnRpbnVvdXNMYWJlbCBWZXJzaW9uPSI4LjAiIFVuaXRzPSJ0d2lwcyI+Cgk8UGFwZXJPcmllbnRhdGlvbj5MYW5kc2NhcGU8L1BhcGVyT3JpZW50YXRpb24+Cgk8SWQ+VGFwZTEybW08L0lkPgoJPFBhcGVyTmFtZT4xMm1tPC9QYXBlck5hbWU+Cgk8TGVuZ3RoTW9kZT5BdXRvPC9MZW5ndGhNb2RlPgoJPExhYmVsTGVuZ3RoPjA8L0xhYmVsTGVuZ3RoPgoJPFJvb3RDZWxsPgoJCTxMZW5ndGg+MDwvTGVuZ3RoPgoJCTxMZW5ndGhNb2RlPkF1dG88L0xlbmd0aE1vZGU+CgkJPEJvcmRlcldpZHRoPjA8L0JvcmRlcldpZHRoPgoJCTxCb3JkZXJTdHlsZT5Tb2xpZDwvQm9yZGVyU3R5bGU+CgkJPEJvcmRlckNvbG9yIEFscGhhPSIyNTUiIFJlZD0iMCIgR3JlZW49IjAiIEJsdWU9IjAiIC8+CgkJPFN1YmNlbGxzT3JpZW50YXRpb24+SG9yaXpvbnRhbDwvU3ViY2VsbHNPcmllbnRhdGlvbj4KCQk8U3ViY2VsbHM+CgkJCTxDZWxsPgoJCQkJPEJhcmNvZGVPYmplY3Q+CgkJCQkJPE5hbWU+S09EIEtSRVNLT1dZPC9OYW1lPgoJCQkJCTxGb3JlQ29sb3IgQWxwaGE9IjI1NSIgUmVkPSIwIiBHcmVlbj0iMCIgQmx1ZT0iMCIgLz4KCQkJCQk8QmFja0NvbG9yIEFscGhhPSIwIiBSZWQ9IjI1NSIgR3JlZW49IjI1NSIgQmx1ZT0iMjU1IiAvPgoJCQkJCTxMaW5rZWRPYmplY3ROYW1lIC8+CgkJCQkJPFJvdGF0aW9uPlJvdGF0aW9uMDwvUm90YXRpb24+CgkJCQkJPElzTWlycm9yZWQ+RmFsc2U8L0lzTWlycm9yZWQ+CgkJCQkJPElzVmFyaWFibGU+RmFsc2U8L0lzVmFyaWFibGU+CgkJCQkJPEdyb3VwSUQ+LTE8L0dyb3VwSUQ+CgkJCQkJPElzT3V0bGluZWQ+RmFsc2U8L0lzT3V0bGluZWQ+CgkJCQkJPFRleHQ+VVJMOlRPS0VOX1VSTDwvVGV4dD4KCQkJCQk8VHlwZT5RUkNvZGU8L1R5cGU+CgkJCQkJPFNpemU+U21hbGw8L1NpemU+CgkJCQkJPFRleHRQb3NpdGlvbj5Ob25lPC9UZXh0UG9zaXRpb24+CgkJCQkJPFRleHRGb250IEZhbWlseT0iQXJpYWwiIFNpemU9IjgiIEJvbGQ9IkZhbHNlIiBJdGFsaWM9IkZhbHNlIiBVbmRlcmxpbmU9IkZhbHNlIiBTdHJpa2VvdXQ9IkZhbHNlIiAvPgoJCQkJCTxDaGVja1N1bUZvbnQgRmFtaWx5PSJBcmlhbCIgU2l6ZT0iOCIgQm9sZD0iRmFsc2UiIEl0YWxpYz0iRmFsc2UiIFVuZGVybGluZT0iRmFsc2UiIFN0cmlrZW91dD0iRmFsc2UiIC8+CgkJCQkJPFRleHRFbWJlZGRpbmc+Tm9uZTwvVGV4dEVtYmVkZGluZz4KCQkJCQk8RUNMZXZlbD4wPC9FQ0xldmVsPgoJCQkJCTxIb3Jpem9udGFsQWxpZ25tZW50PkNlbnRlcjwvSG9yaXpvbnRhbEFsaWdubWVudD4KCQkJCQk8UXVpZXRab25lc1BhZGRpbmcgTGVmdD0iMCIgVG9wPSIwIiBSaWdodD0iMCIgQm90dG9tPSIwIiAvPgoJCQkJPC9CYXJjb2RlT2JqZWN0PgoJCQkJPExlbmd0aD43MjAuMDAwMDAwMDAwMDAzPC9MZW5ndGg+CgkJCQk8TGVuZ3RoTW9kZT5GaXhlZDwvTGVuZ3RoTW9kZT4KCQkJCTxCb3JkZXJXaWR0aD4wPC9Cb3JkZXJXaWR0aD4KCQkJCTxCb3JkZXJTdHlsZT5Tb2xpZDwvQm9yZGVyU3R5bGU+CgkJCQk8Qm9yZGVyQ29sb3IgQWxwaGE9IjI1NSIgUmVkPSIwIiBHcmVlbj0iMCIgQmx1ZT0iMCIgLz4KCQkJPC9DZWxsPgoJCQk8Q2VsbD4KCQkJCTxUZXh0T2JqZWN0PgoJCQkJCTxOYW1lPlRFS1NUXzE8L05hbWU+CgkJCQkJPEZvcmVDb2xvciBBbHBoYT0iMjU1IiBSZWQ9IjAiIEdyZWVuPSIwIiBCbHVlPSIwIiAvPgoJCQkJCTxCYWNrQ29sb3IgQWxwaGE9IjAiIFJlZD0iMjU1IiBHcmVlbj0iMjU1IiBCbHVlPSIyNTUiIC8+CgkJCQkJPExpbmtlZE9iamVjdE5hbWUgLz4KCQkJCQk8Um90YXRpb24+Um90YXRpb24wPC9Sb3RhdGlvbj4KCQkJCQk8SXNNaXJyb3JlZD5GYWxzZTwvSXNNaXJyb3JlZD4KCQkJCQk8SXNWYXJpYWJsZT5GYWxzZTwvSXNWYXJpYWJsZT4KCQkJCQk8R3JvdXBJRD4tMTwvR3JvdXBJRD4KCQkJCQk8SXNPdXRsaW5lZD5GYWxzZTwvSXNPdXRsaW5lZD4KCQkJCQk8SG9yaXpvbnRhbEFsaWdubWVudD5MZWZ0PC9Ib3Jpem9udGFsQWxpZ25tZW50PgoJCQkJCTxWZXJ0aWNhbEFsaWdubWVudD5NaWRkbGU8L1ZlcnRpY2FsQWxpZ25tZW50PgoJCQkJCTxUZXh0Rml0TW9kZT5TaHJpbmtUb0ZpdDwvVGV4dEZpdE1vZGU+CgkJCQkJPFVzZUZ1bGxGb250SGVpZ2h0PlRydWU8L1VzZUZ1bGxGb250SGVpZ2h0PgoJCQkJCTxWZXJ0aWNhbGl6ZWQ+RmFsc2U8L1ZlcnRpY2FsaXplZD4KCQkJCQk8U3R5bGVkVGV4dD4KCQkJCQkJPEVsZW1lbnQ+CgkJCQkJCQk8U3RyaW5nIHhtbDpzcGFjZT0icHJlc2VydmUiPlRPS0VOX05BTUUKPC9TdHJpbmc+CgkJCQkJCQk8QXR0cmlidXRlcz4KCQkJCQkJCQk8Rm9udCBGYW1pbHk9IkFyaWFsIiBTaXplPSIxMiIgQm9sZD0iVHJ1ZSIgSXRhbGljPSJGYWxzZSIgVW5kZXJsaW5lPSJGYWxzZSIgU3RyaWtlb3V0PSJGYWxzZSIgLz4KCQkJCQkJCQk8Rm9yZUNvbG9yIEFscGhhPSIyNTUiIFJlZD0iMCIgR3JlZW49IjAiIEJsdWU9IjAiIEh1ZVNjYWxlPSIxMDAiIC8+CgkJCQkJCQk8L0F0dHJpYnV0ZXM+CgkJCQkJCTwvRWxlbWVudD4KCQkJCQkJPEVsZW1lbnQ+CgkJCQkJCQk8U3RyaW5nIHhtbDpzcGFjZT0icHJlc2VydmUiPlRPS0VOX1RFTVBFUkFUVVJFKkMgLyBUT0tFTl9USU1FbWluPC9TdHJpbmc+CgkJCQkJCQk8QXR0cmlidXRlcz4KCQkJCQkJCQk8Rm9udCBGYW1pbHk9IkFyaWFsIiBTaXplPSIxMiIgQm9sZD0iRmFsc2UiIEl0YWxpYz0iRmFsc2UiIFVuZGVybGluZT0iRmFsc2UiIFN0cmlrZW91dD0iRmFsc2UiIC8+CgkJCQkJCQkJPEZvcmVDb2xvciBBbHBoYT0iMjU1IiBSZWQ9IjAiIEdyZWVuPSIwIiBCbHVlPSIwIiBIdWVTY2FsZT0iMTAwIiAvPgoJCQkJCQkJPC9BdHRyaWJ1dGVzPgoJCQkJCQk8L0VsZW1lbnQ+CgkJCQkJPC9TdHlsZWRUZXh0PgoJCQkJPC9UZXh0T2JqZWN0PgoJCQkJPExlbmd0aD4yNTc5LjQ5MDM1MzI2MDg3PC9MZW5ndGg+CgkJCQk8TGVuZ3RoTW9kZT5BdXRvPC9MZW5ndGhNb2RlPgoJCQkJPEJvcmRlcldpZHRoPjA8L0JvcmRlcldpZHRoPgoJCQkJPEJvcmRlclN0eWxlPlNvbGlkPC9Cb3JkZXJTdHlsZT4KCQkJCTxCb3JkZXJDb2xvciBBbHBoYT0iMjU1IiBSZWQ9IjAiIEdyZWVuPSIwIiBCbHVlPSIwIiAvPgoJCQk8L0NlbGw+CgkJPC9TdWJjZWxscz4KCTwvUm9vdENlbGw+CjwvQ29udGludW91c0xhYmVsPg==
</div>
<script src="http://labelwriter.com/software/dls/sdk/js/DYMO.Label.Framework.3.0.js" type="text/javascript" charset="UTF-8"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" ></script>
<script>
	APIACCESS="replaceme"
	dymo.label.framework.init(init);
	printerName="";
	canPrint=false;
	shorturl="";

	function init() {
		printers = dymo.label.framework.getPrinters();
		for(var i = 0; i < printers.length; i++) {
			var printer = printers[i];
		}
		if (printers.length==0){
			alert("No printers!");
			return;
		}
		printerName=printers[0].name;
		canPrint=true;
	}
	function getShortUrl(){
		var localResult="";
		jQuery.ajax({
			url: "http://api.bit.ly/v3/shorten?"+APIACCESS+"&longUrl="+document.getElementById("URL").value+"&format=json",
			success: function (result) {
				localResult=result.data.url;
			},
			async: false
		});
		return localResult;
	}
	function genLabel(){
		shorturl=getShortUrl();
		return atob(document.getElementById("xml").innerHTML).
			replace("TOKEN_NAME",document.getElementById("name").value).
			replace("TOKEN_TEMPERATURE",document.getElementById("brewTemperature").value).
			replace("TOKEN_TIME",document.getElementById("brewTime").value).
			replace("TOKEN_URL",shorturl);
	}
	function preview() {
		if (!canPrint) return;
		var labelXml = genLabel();
		var image = document.getElementById('preview');
		var pngData = dymo.label.framework.renderLabel(labelXml, "", printerName);
		image.src = "data:image/png;base64," + pngData;

	}
	function print(){
		if (!canPrint) return;
		var labelXml = genLabel();
		var image = document.getElementById('preview');

		var paramsXml = dymo.label.framework. createTapePrintParamsXml ({ copies: 1 });
		var labelSetXml = new dymo.label.framework.LabelSetBuilder();
		var record = labelSetXml.addRecord();
		record.setText("Address", "Test Address String");
		dymo.label.framework.printLabel(printerName, paramsXml, labelXml, labelSetXml);
		
	}
</script>
<table>
	<tr><td style="text-align: right">Name</td><td><input type="text" id="name"></td></tr>
	<tr><td style="text-align: right">Brew temperature</td><td><input type="text" id="brewTemperature"></td></tr>
	<tr><td style="text-align: right">Brew time</td><td><input type="text" id="brewTime"></td></tr>
	<tr><td style="text-align: right">URL</td><td><input type="text" id="URL"></td></tr>
</table>
<button onClick="preview()">PREVIEW</button>
<button onClick="print()">PRINT</button><br />
<img id="preview" />